## 05-需求分析基础

### 5.1 需求分析的原因

需求获取中得到的信息仅仅解释了用户对系统的期待，还不是开发者能够立即加以实现的解决方案。

需求分析的任务是：

1. 建立分析模型，达成用户和开发者对需求信息的共同理解
2. 依据共同理解，创建软件系统解决方案

### 5.2 需求分析模型

#### 模型

模型是对事物的抽象，隐去了复杂的，不必要的细节，帮助人们更好的认识事物。

#### 建模

建立模型的过程被称为建模，目标是建立系统的一个表示，以精确一致的方式描述系统，使得系统使用更加容易。

主要的手段有抽象和分解。

#### 需求分析模型

需求分析模型是介于用户语言和软件内部构造的一种表示，既使用用户语言，也使用类，函数等软件构造的一些内部语言。

常见的需求分析方法：

- 结构化方法
  - 数据流图
  - ER 图
- 面向对象方法
  - 类图
  - 用例图
  - 系统顺序图
  - 状态图

### 5.3 结构化方法

#### 数据流图

将系统看作过程的集合，过程就是对数据的处理和转换

数据流图的组件：

- 外部实体
- 数据流
- 存储
- 过程

#### 数据流图的语法规则

1. 过程必须接受输入，产生有差异的输出
2. 数据流必须和过程关联，要不然是过程的输入，要不然是过程的输出
3. 每个对象都应该有自己的标识符，过程使用动词，其他使用名词

#### 数据流图的分层结构

1. 上下文图：把整个系统看作一个黑盒，明确了系统的边界，描述系统和外界实体之间的交互
2. 0 层图：概述了整个系统的功能，这一级别的过程在系统功能这个级别的抽象
3. N 层图，对 N 层图中的过程分解得到 N + 1 层图（N>=0)
4. 过程分解的平衡原则：要求子图的输入流，输出流与父过程保持一致

#### 实体关系图

数据流图主要关注数据的流动，描述了一种动态的信息，对数据的定义和结构较少涉及。

实体关系图主要描述数据的结构，定义，以及数据之间的关系。

### 5.4 面向对象分析方法

面向对象分析方法把系统看作对象的集合，有更好的自然性和可复用性，更容易实现从设计向实现的转化。

#### 用例

面向对象分析方法将用例作为需求获取和组织的主要手段。

定义：
在系统和外部对象交互的过程中所执行的行为序列的描述，包括各种不同的和错误的序列，他们能够联合提供一种有价值的服务。

省流：用例描述了在不同条件下系统对某一个用户请求的响应。

根据用户的请求和请求时的系统条件，系统将执行不同的行为序列，每个行为序列被称为一个场景，用例是相关的场景的集合。

#### 用例图

1. 基本元素
   - 用例：用椭圆来表示，表示了一个目标/系统特性，这是在需求开发阶段得到的
   - 参与者：用一个小人来表示，表示了一个角色
   - 系统边界
   - 关系

2. 建立
   - 进行目标分析确定解决方向：确定项目目标，定义高层次系统特性
   - 寻找参与者
   - 寻找用例
   - 细化用例：用例的粒度不宜太粗，也不宜太细，一个用例要完成一个对应的业务目标

#### 用例描述

对用例的文档化表述，要注意的是：

1. 围绕交互进行场景描述
2. 保持规格说明级别的语言，尽量不要设计软件内部构造
3. 根据模板来编写

#### 概念类图（领域模型）

1. 基本要素
   - 类
   - 对象
   - 链接
   - 关联
   - 聚合
   - 继承（泛化特化关系）

一般类图中只有重要属性，不标识方法，也不标出属性的数据类型。

2. 建立概念类图

   - 起始于用例描述文本，包含两个步骤：
   - 对每个用例文本描述，建立局部的概念类图
     - 根据用例文本描述，识别候选类，常用的是名词分析法
     - 筛选候选类，确定概念类，标准是看该类的对象是否需要维护状态和行为
     - 识别关联
     - 识别重要属性
   - 将局部概念类图合并，建立软件系统的整体概念类图

   #### 交互图（顺序图）

   顺序图描述了对象之间的协作，是用例的实现。

   ##### 系统顺序图

   建立系统顺序图的步骤：

   1. 确定上下文环境
   2. 根据用例描述找到参与交互的对象
   3. 添加消息

   #### 状态图

   状态图基于有限状态机理论，描述了系统状态之间的转移关系，可以描述比较复杂的对象协作交互。

   #### 状态图的要素

   1. 开始状态
   2. 状态
   3. 结束状态
   4. 事件
   5. 监护条件
   6. 活动
   7. 转换

   #### 状态图的建立

   1. 确定上下文环境，确定状态的主体，可以选择类，用例，多个用例，或者整个系统
   2. 识别状态
   3. 建立状态转换
   4. 补充详细信息，完善状态图

### 5.5 使用需求分析方法细化和明确需求

建立上述的需求分析模型的最终目的是为了改进用例文本，最后建立系统级需求。

基于顺序图可以发现用例文本中的交互不足，基于概念类图可以发现用例文本中是否缺乏问题域知识补充...

### 总结

需求分析是把前面需求获取得到的信息进行建模，以求和用户达成共识，并初步得到一个可实现的方案。