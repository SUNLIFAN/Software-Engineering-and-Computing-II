## 11-详细设计基础

### 11.1 详细设计概述

#### 详细设计的出发点

详细设计的出发点是需求开发的结果（软件需求规格说明和需求分析模型）以及软件体系结构的结果（软件体系结构设计方案与原型）。

#### 详细设计的上下文

在软件体系结构原型代码中实现了概要功能需求和关键性非功能需求，在详细设计阶段需要以需求为驱动，实现所有功能性需求和非功能性需求。

详细设计的结果是能够指导程序员编程的详细设计文档和详细设计原型代码。在详细设计文档中需要明确定义：

1. 模块结构及其接口
2. 类结构，类的协作，类接口（面向对象分析方法）
3. 控制结构和函数接口（结构化分析方法）
4. 重要的数据结构和算法逻辑

原型代码则是在体系结构原型的基础上扩展落实详细设计的实现，以及对相应的详细设计进行验证。

### 11.2 结构化设计

结构化设计按算法分解任务，将任务顺序分解为一系列流程。

结构化设计的主要建模技术是结构图，前面的需求分析模型中已经得到了数据流图，结构化设计的工作中心就是将数据流图转化为结构图。

从数据流图向结构图转化的方法：

1. 找到输入，输出的最高抽象点，将整个数据流划分为输入，转换，输出三个模块
2. 对每个模块递归地分解

### 11.3 面向对象设计

#### 11.3.1 面向对象设计的过程

1. 设计模型建立
   - 通过职责建立静态设计模型
     - 抽象出类的职责
     - 抽象出类之间的关系
     - 添加辅助类
   - 通过协作建立动态设计模型
     - 抽象出对象之间的协作
     - 明确对象的创建
     - 选择合适的控制风格
2. 设计模型重构
   - 根据模块化的思想进行重构，目标为高内聚低耦合
   - 明确对象的创建
   - 利用设计模式重构

#### 11.3.2 通过职责建立静态设计模型

1. 抽象对象的职责

   - 类是对象的抽象
   - 有数据职责和行为职责
   - 数据职责通过属性实现
   - 行为职责通过方法实现

   如何分配职责：信息专家原则：把职责分配给持有能够完成这个职责的数据的对象

2. 抽象类之间的关系

   - 依赖：使用到就算依赖，并不长期持有引用，A uses B
   - 普通关联：长期持有引用，A has a B
   - 聚合：暗含一种集合所属关系，A owns B, 被聚合的对象还可以被别的对象关联，是可共享的。
   - 组合：有一种生命周期关系，不存在两个包含对象对同一个被包含对象的共享。B is part of A
   - 继承：B is A
   - 实现：B implements A

3. 添加辅助类
   - 接口类
   - 记录类
   - 启动类
   - 控制器类
   - 实现数据类型的类
   - 容器类

#### 11.3.3 通过协作建立动态模型

1. 抽象对象之间的协作
   - 两种方式：
     - 从小到大，将对象的小职责聚合成大职责
     - 从大到小，将大职责分配给各个小对象
     - 一般两种方式会结合使用

顺序图可以表示对象之间的交互，顺序图主要分为两个部分：

 	1）对象本身

​	 2）对象之间的消息流

- 同步消息：发送者等候直到消息返回，用实线三角箭头表示
- 异步消息：发送者在消息发送后继续执行，用实线鱼骨箭头表示
- 同步消息返回：接受同步消息者执行结束后返回消息给发送者，用虚线鱼骨箭头表示

2. 明确对象的创建

![](https://img2022.cnblogs.com/blog/2302323/202206/2302323-20220610114400405-1443297984.png)

3. 选择合适的控制风格

   - 集中式
   - 委托式
   - 分散式

   使用控制器使得外部展示和内部领域业务逻辑解耦。

### 11.4 为类间协作开发集成测试用例

类间协作的桩程序叫做 Mock Object, 实现比较简单，可以不经过测试就能保证正确性。

### 11.5 详细设计文档描述

### 11.6 详细设计评审

使用检查清单
